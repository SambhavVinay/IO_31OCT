<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detection Logs | Military Radar System</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Courier New", monospace;
    }

    body {
      background: #0a0a12;
      color: #00ff41;
      min-height: 100vh;
      padding: 40px 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      border-bottom: 1px solid #00ff41;
      padding-bottom: 20px;
    }

    .main-title {
      font-size: 2.5rem;
      font-weight: 700;
      letter-spacing: 3px;
      margin-bottom: 10px;
      color: #00ff41;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 1.1rem;
      color: #00ff41;
      letter-spacing: 2px;
    }

    .stats-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-item {
      background: #0f0f1a;
      border: 1px solid #00ff41;
      border-radius: 2px;
      padding: 20px;
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: #00ff41;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #00ff41;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .logs-container {
      background: #0f0f1a;
      border-radius: 2px;
      padding: 25px;
      border: 1px solid #00ff41;
      margin-bottom: 30px;
    }

    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .table-title {
      font-size: 1.5rem;
      color: #00ff41;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .controls {
      display: flex;
      gap: 15px;
    }

    .btn {
      background: #0a0a12;
      color: #00ff41;
      border: 1px solid #00ff41;
      padding: 10px 20px;
      border-radius: 2px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn:hover {
      background: #00ff41;
      color: #0a0a12;
    }

    .btn-danger {
      border: 1px solid #ff0000;
      color: #ff0000;
    }

    .btn-danger:hover {
      background: #ff0000;
      color: #0a0a12;
    }

    .logs-table {
      width: 100%;
      border-collapse: collapse;
      background: #0a0a12;
      border: 1px solid #00ff41;
    }

    .logs-table th {
      background: #0f0f1a;
      color: #00ff41;
      padding: 15px 20px;
      text-align: left;
      font-weight: 600;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-bottom: 1px solid #00ff41;
    }

    .logs-table td {
      padding: 15px 20px;
      border-bottom: 1px solid rgba(0, 255, 65, 0.2);
      color: #00ff41;
    }

    .logs-table tr:last-child td {
      border-bottom: none;
    }

    .logs-table tr:hover {
      background: rgba(0, 255, 65, 0.05);
    }

    .distance-cell {
      color: #ff0000;
      font-weight: 600;
    }

    .action-cell {
      text-align: center;
    }

    .delete-btn {
      color: #ff0000;
      text-decoration: none;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 2px;
      background: #1a0a0a;
      border: 1px solid #ff0000;
      transition: all 0.2s ease;
      text-transform: uppercase;
      font-size: 0.8rem;
      letter-spacing: 1px;
    }

    .delete-btn:hover {
      background: #ff0000;
      color: #0a0a12;
    }

    .no-data {
      text-align: center;
      padding: 40px;
      color: #00ff41;
      font-size: 1.1rem;
    }

    .footer {
      text-align: center;
      margin-top: 40px;
      color: #00ff41;
      font-size: 0.9rem;
      border-top: 1px solid #00ff41;
      padding-top: 20px;
    }

    @media (max-width: 768px) {
      .stats-bar {
        grid-template-columns: 1fr;
      }
      
      .logs-table {
        font-size: 0.8rem;
      }
      
      .logs-table th,
      .logs-table td {
        padding: 10px 12px;
      }
      
      .table-header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
    }

    @media (max-width: 480px) {
      .main-title {
        font-size: 2rem;
      }
      
      .container {
        padding: 0 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="main-title">DETECTION LOGS</h1>
      <div class="subtitle">TACTICAL OBJECT DETECTION HISTORY</div>
    </div>

    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-number">{{ logs|length }}</div>
        <div class="stat-label">Total Records</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">
          {% if logs %}
            {{ (logs|map(attribute='value')|max)|default(0) }}
          {% else %}
            0
          {% endif %}
        </div>
        <div class="stat-label">Max Distance (cm)</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">
          {% if logs %}
            {{ (logs|selectattr('property_name', 'equalto', 'ultrasonic')|list|length) }}
          {% else %}
            0
          {% endif %}
        </div>
        <div class="stat-label">Ultrasonic Readings</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">
          {% if logs %}
            {{ logs[0].updated_at.strftime('%H:%M') if logs else 'N/A' }}
          {% endif %}
        </div>
        <div class="stat-label">Last Update</div>
      </div>
    </div>

    <div class="logs-container">
      <div class="table-header">
        <h2 class="table-title">Detection History</h2>
        <div class="controls">
          <a href="{{ url_for('home') }}" class="btn">Back To Radar</a>
          {% if logs %}
            <a href="/deletelogs/all" class="btn btn-danger" onclick="return confirm('Delete all logs?')">Clear All</a>
          {% endif %}
        </div>
      </div>

      <table class="logs-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Device ID</th>
            <th>Sensor Type</th>
            <th>Distance</th>
            <th>Timestamp</th>
            <th class="action-cell">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% if logs %}
            {% for log in logs %}
              <tr>
                <td>#{{ log.id }}</td>
                <td>DEV-{{ log.thing_id }}</td>
                <td>{{ log.property_name|upper }}</td>
                <td class="distance-cell">{{ log.value }} cm</td>
                <td>
                  {% if log.updated_at %}
                    {{ log.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}
                  {% else %}
                    N/A
                  {% endif %}
                </td>
                <td class="action-cell">
                  <a href="/deletelogs/{{ log.id }}" class="delete-btn" 
                     onclick="return confirm('Delete this detection record?')">
                    Delete
                  </a>
                </td>
              </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="6" class="no-data">
                ðŸ“Š No detection records found. Data will appear here when objects are detected.
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>

    <div class="footer">
      Â© RADAR DETECTION SYSTEM | LOGGING & ANALYTICS
    </div>
  </div>

  <script>
    // Auto-refresh logs every 30 seconds
    setInterval(() => {
      window.location.reload();
    }, 30000);
  </script>
</body>
</html>